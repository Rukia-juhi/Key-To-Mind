<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Key To Mind — Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@500&display=swap" rel="stylesheet">
<style>
  :root{
    --ink:#0e2b2f; --muted:#264a50;
    --glass:rgba(255,255,255,.18); --glass-brd:rgba(255,255,255,.45);
    --accent:#16c1b5; --accent-dark:#0b8d83;
    --ok:#2e7d32; --warn:#ef6c00; --high:#c62828;
    --sidebar:#ffffffa8;
  }
  body{
    margin:0; font-family:'Inter',system-ui,Segoe UI,Roboto,sans-serif; color:var(--ink);
    min-height:100svh; background:
      radial-gradient(1200px 600px at -10% -10%, #bdfbff 0%, transparent 45%),
      radial-gradient(1200px 800px at 110% 10%, #ffe0f7 0%, transparent 50%),
      radial-gradient(900px 700px at 50% 110%, #fff6c9 0%, transparent 55%),
      linear-gradient(120deg,#b7f5ea 0%,#fde6ff 50%,#fdf6d9 100%);
    background-size:300% 300%; animation:grad 25s ease infinite;
  }
  @keyframes grad{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
  .blob{position:fixed;z-index:0;filter:blur(60px);opacity:.4;mix-blend-mode:multiply}
  .b1{width:420px;height:420px;background:#baf3ff;top:-70px;left:-70px;animation:float 18s ease-in-out infinite}
  .b2{width:360px;height:360px;background:#ffd6f6;bottom:-60px;right:-20px;animation:float 20s ease-in-out infinite 3s}
  @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-22px)}}

  .app{position:relative;z-index:1;display:grid;grid-template-columns:260px 1fr;gap:18px;max-width:1200px;margin:0 auto;padding:18px}
  @media (max-width: 980px){ .app{grid-template-columns:1fr} .sidebar{position:sticky; top:0} }

  .sidebar{
    background:var(--sidebar); border:1px solid var(--glass-brd); backdrop-filter:blur(14px) saturate(120%);
    border-radius:18px; padding:16px; box-shadow:0 12px 30px rgba(0,0,0,.08)
  }
  .brand{display:flex;align-items:center;gap:10px;margin-bottom:10px}
  .brand .logo{width:28px;height:28px}
  .brand .name{font-family:'Poppins',sans-serif;font-weight:600;color:#004d40}
  .nav{display:flex;flex-direction:column;gap:8px;margin-top:10px}
  .nav a{
    display:flex;gap:10px;align-items:center;text-decoration:none;color:#064e46;
    padding:10px 12px;border-radius:12px;border:1px solid transparent
  }
  .nav a:hover{background:#ffffffbf;border-color:#e6f7f5}
  .nav svg{width:18px;height:18px;stroke:#0b8d83}

  .main{display:grid;gap:18px}
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px}
  @media (max-width:980px){ .grid{grid-template-columns:1fr} }

  .card{
    background:var(--glass); border:1px solid var(--glass-brd); backdrop-filter:blur(14px) saturate(120%);
    border-radius:18px; padding:18px; box-shadow:0 18px 40px rgba(0,0,0,.08), inset 0 .5px 0 rgba(255,255,255,.5)
  }
  .card h3{margin:0 0 6px 0}
  .sub{color:var(--muted);margin:0 0 12px}

  .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .stat{background:#ffffffc9;border:1px solid rgba(0,0,0,.06);border-radius:14px;padding:12px}
  .stat .k{font-size:1.4rem;font-weight:800}

  .q{margin:14px 0 6px;font-weight:600;color:var(--muted)}
  .opts{display:grid;gap:8px}
  .opt{display:flex;align-items:center;gap:10px;background:#ffffffcc;border:1px solid rgba(0,0,0,.06);padding:10px 12px;border-radius:12px}
  .opt input[type=radio]{appearance:none;width:18px;height:18px;border-radius:50%;border:2px solid #8bbfc2;position:relative}
  .opt input[type=radio]::after{content:"";position:absolute;inset:3px;border-radius:50%;background:var(--accent);transform:scale(0);transition:transform .15s}
  .opt input[type=radio]:checked{border-color:var(--accent)} .opt input[type=radio]:checked::after{transform:scale(1)}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .btn{border:0;border-radius:12px;padding:11px 16px;font-weight:700;cursor:pointer}
  .btn.primary{color:#043e3a;background:linear-gradient(135deg,#b9fff6,#8fe8ff);box-shadow:0 10px 18px rgba(15,150,140,.22)}
  .btn.ghost{background:transparent;border:1px solid var(--accent-dark);color:var(--accent-dark)}

  .pill{display:inline-block;padding:6px 12px;border-radius:999px;font-weight:700}
  .low{background:#e8f5e9;color:var(--ok);border:1px solid #c8e6c9}
  .moderate{background:#fff3e0;color:var(--warn);border:1px solid #ffe0b2}
  .high{background:#ffebee;color:var(--high);border:1px solid #ffcdd2}
  ul.clean{margin:8px 0 0 18px} ul.clean li{margin:6px 0}

  .games{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}
  .game{background:#ffffffbf;border:1px solid rgba(0,0,0,.06);border-radius:14px;padding:14px;text-align:center;cursor:pointer;box-shadow:0 8px 22px rgba(0,0,0,.06)}
  .game:hover{transform:translateY(-3px);box-shadow:0 12px 26px rgba(0,0,0,.09)}
  .game .title{font-weight:700;margin-top:6px}

  .dock{
    position:fixed; left:50%; transform:translateX(-50%);
    bottom:18px; z-index:4; display:flex; gap:14px; align-items:center;
    background:rgba(255,255,255,.55); border:1px solid rgba(255,255,255,.7);
    backdrop-filter:blur(14px) saturate(130%); padding:10px 14px; border-radius:999px;
    box-shadow:0 14px 40px rgba(0,0,0,.18)
  }
  .ico{
    width:44px;height:44px;border-radius:50%;display:grid;place-items:center;cursor:pointer;border:1px solid rgba(0,0,0,.06);
    background:#ffffffcc; transition:transform .1s, box-shadow .2s
  }
  .ico:hover{transform:translateY(-2px); box-shadow:0 10px 18px rgba(0,0,0,.12)}
  .ico svg{width:22px;height:22px}

  .fab{
    position:fixed; right:20px; bottom:88px; z-index:5;
    width:62px;height:62px;border-radius:50%; border:0; cursor:pointer;
    background:linear-gradient(135deg,#7ee8df,#80ffea);
    box-shadow:0 16px 38px rgba(0,0,0,.22);
    display:grid;place-items:center;
  }
  .fab:hover{transform:translateY(-2px)}
  .fab svg{width:28px;height:28px;stroke:#005e58}

  .modal{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;z-index:6}
  .shade{position:absolute;inset:0;background:rgba(0,0,0,.25)}
  .sheet{
    position:relative; width:min(720px,92%); background:var(--glass); border:1px solid var(--glass-brd);
    border-radius:18px 18px 0 0; backdrop-filter:blur(16px) saturate(120%); padding:18px 18px 24px;
    box-shadow:0 -10px 30px rgba(0,0,0,.18)
  }
  .sheet header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  .x{background:transparent;border:0;font-size:20px;cursor:pointer}

  .breath-wrap{position:relative;width:180px;height:180px;margin:10px auto}
  .ring{position:absolute;inset:-10px;border-radius:50%;background:radial-gradient(transparent 60%, rgba(22,193,181,.2));filter:blur(6px);animation:pulse 4s ease-in-out infinite}
  .breath{width:100%;height:100%;border-radius:50%;background:radial-gradient(circle at 35% 30%,#4df1e4,#0f8e86 70%);animation:breathe 8s ease-in-out infinite;box-shadow:0 12px 28px rgba(13,125,125,.28), inset 0 0 25px rgba(255,255,255,.25)}
  @keyframes breathe{0%,100%{transform:scale(1);opacity:.92}50%{transform:scale(1.25);opacity:1}}
  @keyframes pulse{0%,100%{transform:scale(1);opacity:.45}50%{transform:scale(1.1);opacity:.7}}

  @media (prefers-reduced-motion: reduce){*{animation:none!important;transition:none!important}}
</style>
</head>
<body>
  <div class="blob b1"></div><div class="blob b2"></div>

  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <svg class="logo" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" fill="#16c1b5" opacity=".35"/><path d="M12 6a4.5 4.5 0 0 0-4.5 4.5c0 1.6.8 2.6 1.7 3.4.6.5.8 1.2.8 2v.6h4v-.6c0-.8.3-1.5.9-2 1-.8 1.6-1.8 1.6-3.4A4.5 4.5 0 0 0 12 6Z" fill="#0b8d83"/></svg>
        <div class="name">Key To Mind</div>
      </div>
      <nav class="nav">
        <a href="#checkin">
          <svg viewBox="0 0 24 24" fill="none"><path d="M3 12h18M12 3v18" stroke-width="2" stroke-linecap="round"/></svg>
          Quick Check-In
        </a>
        <a href="#insights">
          <svg viewBox="0 0 24 24" fill="none"><path d="M4 19V5m8 14V9m8 10V3" stroke-width="2" stroke-linecap="round"/></svg>
          Insights
        </a>
        <a href="#calm">
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 21c4-2 7-5 7-9A7 7 0 1 0 5 12c0 4 3 7 7 9Z" stroke-width="2" stroke-linecap="round"/></svg>
          Calm Tools
        </a>
        <a href="#games">
          <svg viewBox="0 0 24 24" fill="none"><rect x="3" y="6" width="18" height="12" rx="3" stroke-width="2"/><circle cx="8" cy="12" r="1"/><circle cx="16" cy="12" r="1"/></svg>
          Mini Games
        </a>
      </nav>
    </aside>

    <main class="main">
      <section class="card" id="insights">
        <h3>Welcome back 👋</h3>
        <p class="sub">Here’s a quick snapshot. Start a check-in to update your trends.</p>
        <div class="stats">
          <div class="stat"><div class="k" id="statLastScore">—</div><div class="sub">Last stress score</div></div>
          <div class="stat"><div class="k" id="statLevel">—</div><div class="sub">Current level</div></div>
          <div class="stat"><div class="k" id="statStreak">0</div><div class="sub">Daily check-ins</div></div>
        </div>
      </section>

      <div class="grid">
        <section class="card" id="checkin" aria-labelledby="formTitle">
          <h3 id="formTitle">Quick Stress Check (5 Qs)</h3>
          <p class="sub">Takes under a minute.</p>
          <form id="stressForm">
            <div class="q">1) How often do you feel overwhelmed or unable to cope?</div>
            <div class="opts">
              <label class="opt"><input type="radio" name="q1" value="0" required> Never</label>
              <label class="opt"><input type="radio" name="q1" value="1"> Occasionally</label>
              <label class="opt"><input type="radio" name="q1" value="2"> Often</label>
              <label class="opt"><input type="radio" name="q1" value="3"> Almost always</label>
            </div>
            <div class="q">2) How well are you sleeping (quality & duration)?</div>
            <div class="opts">
              <label class="opt"><input type="radio" name="q2" value="0" required> Very well</label>
              <label class="opt"><input type="radio" name="q2" value="1"> Fairly well</label>
              <label class="opt"><input type="radio" name="q2" value="2"> Poorly</label>
              <label class="opt"><input type="radio" name="q2" value="3"> Very poorly</label>
            </div>
            <div class="q">3) Physical symptoms (headache, fatigue, tension)?</div>
            <div class="opts">
              <label class="opt"><input type="radio" name="q3" value="0" required> Never</label>
              <label class="opt"><input type="radio" name="q3" value="1"> Sometimes</label>
              <label class="opt"><input type="radio" name="q3" value="2"> Frequently</label>
              <label class="opt"><input type="radio" name="q3" value="3"> Almost always</label>
            </div>
            <div class="q">4) How easily can you relax or “switch off”?</div>
            <div class="opts">
              <label class="opt"><input type="radio" name="q4" value="0" required> Very easily</label>
              <label class="opt"><input type="radio" name="q4" value="1"> Somewhat easily</label>
              <label class="opt"><input type="radio" name="q4" value="2"> With difficulty</label>
              <label class="opt"><input type="radio" name="q4" value="3"> Not at all</label>
            </div>
            <div class="q">5) Ability to focus on tasks?</div>
            <div class="opts">
              <label class="opt"><input type="radio" name="q5" value="0" required> Very good</label>
              <label class="opt"><input type="radio" name="q5" value="1"> Fair</label>
              <label class="opt"><input type="radio" name="q5" value="2"> Poor</label>
              <label class="opt"><input type="radio" name="q5" value="3"> Very poor</label>
            </div>

            <div class="actions">
              <button class="btn primary" type="submit">Analyze Stress</button>
              <button class="btn ghost" type="button" id="resetBtn">Reset</button>
            </div>
          </form>
        </section>

        <section class="card" id="calm" aria-live="polite">
          <h3>Your Result & Calm Ideas</h3>
          <p class="sub">Personalized suggestions appear here after analysis.</p>
          <div id="badge" class="pill">No result yet</div>
          <p id="scoreText" style="margin:8px 0 0;"></p>
          <h4 style="margin:12px 0 8px;">Suggested Activities</h4>
          <ul id="sugList" class="clean"></ul>

          <hr style="border:none;border-top:1px solid rgba(0,0,0,.08);margin:14px 0">
          <h4>Quick Tools</h4>
          <div class="actions">
            <button class="btn ghost" id="openBreathBtn">💨 Box Breathing</button>
            <!-- UPDATED LINKS -->
            <button class="btn ghost" onclick="window.open('bubble-pop.html','_blank')">💧 Bubble Pop</button>
            <button class="btn ghost" onclick="window.open('snake-zen.html','_blank')">🐍 Zen Snake</button>
            <button class="btn ghost" onclick="window.open('doodle-pad.html','_blank')">🎨 Doodle Pad</button>
          </div>
        </section>
      </div>

      <section class="card" id="games">
        <h3>Mini Games</h3>
        <p class="sub">Light, low-pressure games to unwind.</p>
        <div class="games">
          <!-- UPDATED LINKS -->
          <div class="game" onclick="window.open('bubble-pop.html','_blank')">💧
            <div class="title">Bubble Pop</div>
            <div class="sub">Tap to pop & relax</div>
          </div>
          <div class="game" onclick="window.open('snake-zen.html','_blank')">🐍
            <div class="title">Zen Snake</div>
            <div class="sub">Gentle classic</div>
          </div>
          <div class="game" onclick="window.open('doodle-pad.html','_blank')">🎨
            <div class="title">Rainbow Doodle</div>
            <div class="sub">Express & breathe</div>
          </div>
          <!-- OPTIONAL: memory match (since your folder has it) -->
          <div class="game" onclick="window.open('memory-match.html','_blank')">🧩
            <div class="title">Memory Match</div>
            <div class="sub">Calm focus</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <nav class="dock" aria-label="Quick actions">
    <button class="ico" id="openBreath" title="Box Breathing" aria-label="Open Box Breathing">
      <svg viewBox="0 0 24 24" fill="none" stroke="#0b8d83" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="4" y="4" width="16" height="16" rx="3"></rect><path d="M8 12h8M12 8v8"></path>
      </svg>
    </button>
    <button class="ico" title="Relaxing Games" aria-label="Open Games" onclick="document.getElementById('games').scrollIntoView({behavior:'smooth'})">
      <svg viewBox="0 0 24 24" fill="none" stroke="#0b8d83" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="6" width="18" height="12" rx="3"></rect>
        <circle cx="8" cy="12" r="1"></circle><circle cx="16" cy="12" r="1"></circle>
      </svg>
    </button>
    <button class="ico" title="Go to Check-In" aria-label="Go to Check-In" onclick="document.getElementById('checkin').scrollIntoView({behavior:'smooth'})">
      <svg viewBox="0 0 24 24" fill="none" stroke="#0b8d83" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 19V5M5 12l7-7 7 7"></path>
      </svg>
    </button>
  </nav>

  <!-- UPDATED: FAB points to your psychiatrist page name -->
  <a class="fab" href="psychiatrist-consulation.html" title="Consult a Psychiatrist" aria-label="Consult a Psychiatrist">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 12c2.8 0 5-2.2 5-5S14.8 2 12 2 7 4.2 7 7s2.2 5 5 5Z"/>
      <path d="M20 22a8 8 0 0 0-16 0"/>
      <path d="M8 21h8M12 17v4"/>
    </svg>
  </a>

  <!-- Breathing modal -->
  <div class="modal" id="breathModal" aria-hidden="true">
    <div class="shade"></div>
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="breathTitle">
      <header>
        <h3 id="breathTitle" style="margin:0">💨 Box Breathing</h3>
        <button class="x" data-close="breathModal" aria-label="Close">✕</button>
      </header>
      <div class="breath-wrap"><div class="ring"></div><div class="breath"></div></div>
      <p style="text-align:center">Inhale 4s • Hold 4s • Exhale 4s • Hold 4s — repeat 4 rounds.</p>
    </div>
  </div>

<script>
  const SUGGESTIONS = {
    low: ["2-minute mindful breathing","5–10 min walk","Write 3 small wins","Light neck & shoulder stretch"],
    moderate: ["4-7-8 breathing (3 rounds)","5-4-3-2-1 grounding","3-minute body scan","Nature sounds (3–5 min)"],
    high: ["Box breathing (4 rounds)","Notice 3 sights + 3 sounds","Text/call a friend","Dim screen & silence alerts"]
  };

  const form = document.getElementById('stressForm');
  const resetBtn = document.getElementById('resetBtn');
  const badge = document.getElementById('badge');
  const scoreText = document.getElementById('scoreText');
  const sugList = document.getElementById('sugList');
  const statLastScore = document.getElementById('statLastScore');
  const statLevel = document.getElementById('statLevel');
  const statStreak = document.getElementById('statStreak');

  function assess(vals){
    const total = vals.reduce((a,b)=>a+b,0);
    const level = total <= 4 ? 'low' : total <= 9 ? 'moderate' : 'high';
    return {total, level};
  }
  function setBadge(level){
    badge.className='pill '+(level==='low'?'low':level==='moderate'?'moderate':'high');
    badge.textContent = level==='low'?'Low Stress':level==='moderate'?'Moderate Stress':'High Stress';
  }

  function incStreak(){
    const today = new Date().toDateString();
    const last = localStorage.getItem('ktm_last_check');
    let streak = Number(localStorage.getItem('ktm_streak')||0);
    if(last !== today){ streak += 1; localStorage.setItem('ktm_streak', String(streak)); }
    localStorage.setItem('ktm_last_check', today);
    statStreak.textContent = String(streak);
  }
  (function loadStats(){
    const lastScore = localStorage.getItem('ktm_last_score');
    const lastLevel = localStorage.getItem('ktm_last_level');
    statLastScore.textContent = lastScore ? lastScore : '—';
    statLevel.textContent = lastLevel ? lastLevel.charAt(0).toUpperCase()+lastLevel.slice(1) : '—';
    statStreak.textContent = localStorage.getItem('ktm_streak') || '0';
  })();

  form.addEventListener('submit', (e)=>{
    e.preventDefault();
    const fd = new FormData(form);
    const v = [1,2,3,4,5].map(i=>Number(fd.get('q'+i)));
    const {total, level} = assess(v);
    setBadge(level);
    scoreText.textContent = `Score: ${total} (0–15)`;
    sugList.innerHTML = SUGGESTIONS[level].map(s=>`<li>${s}</li>`).join('');
    localStorage.setItem('ktm_last_score', String(total));
    localStorage.setItem('ktm_last_level', level);
    statLastScore.textContent = String(total);
    statLevel.textContent = level.charAt(0).toUpperCase()+level.slice(1);
    incStreak();
    document.getElementById('calm').scrollIntoView({behavior:'smooth'});
  });

  resetBtn.addEventListener('click', ()=>{ form.reset(); badge.className='pill'; badge.textContent='No result yet'; scoreText.textContent=''; sugList.innerHTML=''; });

  // breathing modal controls
  const breathModal=document.getElementById('breathModal');
  const openBreathBtn=document.getElementById('openBreathBtn');
  document.getElementById('openBreath').onclick=()=>openModal(breathModal);
  if(openBreathBtn) openBreathBtn.onclick=()=>openModal(breathModal);
  breathModal.querySelector('.shade').onclick=()=>closeModal(breathModal);
  breathModal.querySelector('[data-close]').onclick=()=>closeModal(breathModal);
  function openModal(m){ m.style.display='flex'; m.setAttribute('aria-hidden','false'); }
  function closeModal(m){ m.style.display='none'; m.setAttribute('aria-hidden','true'); }
</script>
</body>
</html>
